<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Subscription Form</title>
    <link rel="stylesheet" href="./src/style.css" />
  </head>

  <body>
    <div class="container">
      <div class="login-container">
        <div class="step-info">
          <div class="step-counter-container">
            <div class="step-1">
              <div class="step-count-info-current">
                <h1>1</h1>
              </div>
              <div class="step-count-txt">
                <h4>Step 1</h4>
                <h2>Your Info</h2>
              </div>
            </div>
            <div class="step-2">
              <div class="step-count-info">
                <h1>2</h1>
              </div>
              <div class="step-count-txt">
                <h4>Step 2</h4>
                <h2>Select Plan</h2>
              </div>
            </div>
            <div class="step-3">
              <div class="step-count-info">
                <h1>3</h1>
              </div>
              <div class="step-count-txt">
                <h4>Step 3</h4>
                <h2>Add-ons</h2>
              </div>
            </div>
            <div class="step-4">
              <div class="step-count-info">
                <h1>4</h1>
              </div>
              <div class="step-count-txt">
                <h4>Step 4</h4>
                <h2>Summary</h2>
              </div>
            </div>
          </div>
        </div>
        <div class="form-container">
          
          <!-- Step 1 content -->
          <div id="step1" class="step active">
            <div class="step-top-section">
              <div class="title-container">
                <h1 class="step-title">Personal Info</h1>
                <p class="step-description">
                  Please provide your name, email address, and phone number.
                </p>
              </div>
              <div class="content">
                <div class="form-group">
                  <label for="name">Name</label>
                  <input
                    type="text"
                    id="name"
                    placeholder="e.g. Stephen King"
                  />
                </div>

                <div class="form-group">
                  <label for="email">Email Address</label>
                  <input
                    type="email"
                    id="email"
                    placeholder="stephenking@lorem.com"
                    required
                  />
                </div>

                <div class="form-group">
                  <label for="phone">Phone Number</label>
                  <input
                    type="tel"
                    id="phone"
                    placeholder="e.g. +1 234 567 890"
                  />
                </div>
              </div>
            </div>
            <div class="step-bottom-section">
              <button onclick="nextStep()">Next Step</button>
            </div>
          </div>
          <!-- Step 2 content -->
          <div id="step2" class="step">
            <div class="step-top-section">
              <div class="title-container">
                <h1 class="step-title">Select your plan</h1>
                <p class="step-description">
                  You have the option of monthly of yearly billing.
                </p>
              </div>
              <div id="plan">
                <div class="plan-info plan-selected">
                  <div class="plan-icon">
                    <img
                      src="src/assets/images/icon-arcade.svg"
                      alt="arcade plan image"
                    />
                  </div>
                  <div class="plan-title">
                    <h4 class="plan-name">Arcade</h4>
                    <p class="plan-name" id="arcadePlanPrice">$9/mo</p>
                  </div>
                </div>
                <div class="plan-info">
                  <div class="plan-icon">
                    <img
                      src="src/assets/images/icon-advanced.svg"
                      alt="advanced plan image"
                    />
                  </div>
                  <div class="plan-title">
                    <h4 class="plan-name">Advanced</h4>
                    <p class="plan-price" id="advancedPlanPrice">$12/mo</p>
                  </div>
                </div>
                <div class="plan-info">
                  <div class="plan-icon">
                    <img
                      src="src/assets/images/icon-pro.svg"
                      alt="pro plan image"
                    />
                  </div>
                  <div class="plan-title">
                    <h4 class="plan-name">Pro</h4>
                    <p class="plan-price" id="proPlanPrice">$15/mo</p>
                  </div>
                </div>
              </div>
              <div id="price-toggle">
                Monthly
                <div class="toggle">
                  <div class="toggle-button" id="toggle-button"></div>
                </div>
                Annually
              </div>
            </div>

            <div class="step-bottom-section">
              <h3 onclick="prevStep()">Go Back</h3>
              <button onclick="nextStep()">Next Step</button>
            </div>
          </div>
          <!-- Step 3 content -->
          <div id="step3" class="step">
            <div class="step-top-section">
              <div class="title-container">
                <h1 class="step-title">Pick add-ons</h1>
                <p class="step-description">
                  Add-ons help enhance your gaming experience.
                </p>
              </div>
              <div class="add_on_container">
                <div
                  class="checkbox1"
                  onclick="addonToggleCheckbox('onlineService')"
                >
                  <div class="add_on_title">
                    <input type="checkbox" id="onlineService" value="1" />
                    <div>
                      <h3>Online Service</h3>
                      <p>Access to multiplayer games</p>
                    </div>
                  </div>
                  <p class="addOnPrice" id="onlineServicePrice">$1/mo</p>
                </div>
                <div
                  class="checkbox2"
                  onclick="addonToggleCheckbox('largerStorage')"
                >
                  <div class="add_on_title">
                    <input type="checkbox" id="largerStorage" value="1" />
                    <div>
                      <h3>Larger Storage</h3>
                      <p>Extra 1TB of cloud save</p>
                    </div>
                  </div>
                  <p class="largerStorage" id="largerStoragePrice">$2/mo</p>
                </div>
                <div
                  class="checkbox3"
                  onclick="addonToggleCheckbox('customProfile')"
                >
                  <div class="add_on_title">
                    <input type="checkbox" id="customProfile" value="1" />
                    <div>
                      <h3>Customizable Profile</h3>
                      <p>Custom theme on your profile</p>
                    </div>
                  </div>
                  <p class="customProfile" id="customProfilePrice">$2/mo</p>
                </div>
              </div>
            </div>
            <div class="step-bottom-section">
              <h3 id="step_back" onclick="prevStep()">Go Back</h3>
              <button onclick="nextStep()">Next Step</button>
            </div>
          </div>
          <!-- Step 4 content -->
          <div id="step4" class="step">
            <div class="step-top-section">
              <div class="title-container">
                <h1 class="step-title">Finishing up</h1>
                <p class="step-description">
                  Double-check everything looks OK before confirming.
                </p>
              </div>
              <div class="final-plan-info">
                <div class="final-info-row">
                  <div class="info-left">
                    <h4 id="final-plan-name">Arcade(Yearly)</h4>
                    <p onclick="tenureToggle()">Change</p>
                  </div>
                  <div class="info-right">
                    <h4 id="final-plan-price">$90/yr</h4>
                  </div>
                </div>
                <hr />
                <ul id="add-ons-list">
                  <li id="add-on-list-item-1">
                    <p id="add-on-title">Online service</p>
                    <p id="add-on-price">+10/yr</p>
                  </li>
                  <li id="add-on-list-item-2">
                    <p id="add-on-title">Larger storage</p>
                    <p id="add-on-price">+20/yr</p>
                  </li>
                  <li id="add-on-list-item-3">
                    <p id="add-on-title">Customizable Profile</p>
                    <p id="add-on-price">+20/yr</p>
                  </li>
                </ul>
              </div>
              <div class="plan-total-price-container">
                <p>Total (<span>per year</span>)</p>
                <h3 id="plan-total-price">$120/yr</h3>
              </div>
            </div>
            <div class="step-bottom-section">
              <h3 onclick="prevStep()">Go Back</h3>
              <button id="confirm" onclick="nextStep()">Confirm</button>
            </div>
          </div>
          <!-- Confirm page -->
          <div id="step5" class="step">
            <img src="src/assets/images/icon-thank-you.svg" alt="" />
            <h1 class="step-title">Thank you!</h1>
            <p id="finalSummary">
              Thanks for confirming your subscription! We hope you have fun
              using our platform. If you ever need support, please feel free to
              email us at support@lermgaing.com
            </p>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script>
let initialFormData = {
  currentStep: 1,
  name: null,
  email: null,
  phoneNumber: null,
  planName: "arcade",
  planTenure: "monthly",
  planAddOns: [],
  total: "$9/mo",
};

let formData = { ...initialFormData };

//  Toggle between Monthly and Annual prices
const prices = {
  plans: { arcade: 9, advanced: 12, pro: 15 },
  addOnPrices: {
    onlineService: { title: "Online Service", price: 1 },
    largerStorage: { title: "Larger Storage", price: 2 },
    customProfile: { title: "Customizable Profile", price: 2 },
  },
};

window.addEventListener("load", function () {
  // Reset checkboxes
  const checkboxes = document.querySelectorAll('input[type="checkbox"]');
  checkboxes.forEach((checkbox) => {
    checkbox.checked = false;
  });

  // Reset the planAddOns array
  formData.planAddOns = [];

  // Update the summary
  updateSummary();
});

const updatePrice = (tenure) => {
  // Selecting DOM Elements
  const arcadePrice = document.getElementById("arcadePlanPrice");
  const advancedPrice = document.getElementById("advancedPlanPrice");
  const proPrice = document.getElementById("proPlanPrice");
  const onlineServicePrice = document.getElementById("onlineServicePrice");
  const largerStoragePrice = document.getElementById("largerStoragePrice");
  const customProfilePrice = document.getElementById("customProfilePrice");
  let term = null;
  if (tenure != "monthly") {
    term = "yr";
    // Switch to annual prices
    arcadePrice.innerHTML = `$${prices.plans.arcade * 10}/${term}`;
    advancedPrice.innerHTML = `$${prices.plans.advanced * 10}/${term}`;
    proPrice.innerHTML = `$${prices.plans.pro * 10}/${term}`;
    onlineServicePrice.innerHTML = `$${
      prices.addOnPrices.onlineService.price * 10
    }/${term}`;
    largerStoragePrice.innerHTML = `$${
      prices.addOnPrices.largerStorage.price * 10
    }/${term}`;
    customProfilePrice.innerHTML = `$${
      prices.addOnPrices.customProfile.price * 10
    }/${term}`;
  } else {
    term = "mo";
    // Switch to monthly prices
    arcadePrice.innerHTML = `$${prices.plans.arcade}/${term}`;
    advancedPrice.innerHTML = `$${prices.plans.advanced}/${term}`;
    proPrice.innerHTML = `$${prices.plans.pro}/${term}`;
    onlineServicePrice.innerHTML = `$${prices.addOnPrices.onlineService.price}/${term}`;
    largerStoragePrice.innerHTML = `$${prices.addOnPrices.largerStorage.price}/${term}`;
    customProfilePrice.innerHTML = `$${prices.addOnPrices.customProfile.price}/${term}`;
  }
  updateSummary();
};

function tenureToggle() {
  const toggleDiv = document.querySelector(".toggle");
  toggleDiv.classList.toggle("right");
  formData.planTenure =
    formData.planTenure == "monthly" ? "annually" : "monthly";
  updatePrice(formData.planTenure);
  updateSummary();
}
document.addEventListener("DOMContentLoaded", function () {
  const toggleButton = document.getElementById("price-toggle");

  toggleButton.addEventListener("click", tenureToggle);
});

function nextStep() {
  if (formData.currentStep == 1) {
    const name = document.getElementById("name").value;
    const email = document.getElementById("email").value;
    const phone = document.getElementById("phone").value;
    if (name == "" || email == "" || phone == "") {
      alert("Please enter all the required fields");
      return;
    }
    formData.name = name;
    formData.email = email;
    formData.phone = phone;
  }

  // Update current Step style
  const currentStepCount = document.querySelector(
    `.step-${formData.currentStep}`
  );

  const nextStepCount = document.querySelector(
    `.step-${formData.currentStep + 1}`
  );
  if (nextStepCount && currentStepCount) {
    currentStepCount
      .querySelector(".step-count-info-current")
      .classList.replace("step-count-info-current", "step-count-info");

    nextStepCount
      .querySelector(".step-count-info")
      .classList.replace("step-count-info", "step-count-info-current");
  } else if (!nextStepCount) {
    currentStepCount
      .querySelector(".step-count-info-current")
      .classList.replace("step-count-info-current", "step-count-info");
  }

  const currentStepElement = document.getElementById(
    `step${formData.currentStep}`
  );
  const nextStepElement = document.getElementById(
    `step${formData.currentStep + 1}`
  );

  if (currentStepElement && nextStepElement) {
    currentStepElement.classList.remove("active");
    nextStepElement.classList.add("active");
    formData.currentStep++;
  }
  updateSummary();
}

function prevStep() {
  // Update current Step style
  const currentStepCount = document.querySelector(
    `.step-${formData.currentStep}`
  );

  const prevStepCount = document.querySelector(
    `.step-${formData.currentStep - 1}`
  );

  prevStepCount
    .querySelector(".step-count-info")
    .classList.replace("step-count-info", "step-count-info-current");

  currentStepCount
    .querySelector(".step-count-info-current")
    .classList.replace("step-count-info-current", "step-count-info");

  const currentStepElement = document.getElementById(
    `step${formData.currentStep}`
  );
  const prevStepElement = document.getElementById(
    `step${formData.currentStep - 1}`
  );

  if (currentStepElement && prevStepElement) {
    currentStepElement.classList.remove("active");
    prevStepElement.classList.add("active");
    formData.currentStep--;
  }
  updateSummary();
}

function updateSummary() {
  const finalPlanName = document.getElementById("final-plan-name");
  finalPlanName.textContent = `  
    ${formData.planName[0].toUpperCase() + formData.planName.substring(1)}(${
    formData.planTenure[0].toUpperCase() + formData.planTenure.substring(1)
  })`;

  const currentPlanPrice =
    formData.planTenure == "monthly"
      ? `$${prices.plans[formData.planName]}/mo`
      : `$${prices.plans[formData.planName] * 10}/yr`;
  const addOnTotal = formData.planAddOns.reduce((total, addon) => {
    return total + (prices.addOnPrices[addon]?.price || 0);
  }, 0);
  // Updating summary page plan price
  document.getElementById("final-plan-price").innerHTML = currentPlanPrice;

  let totalPrice =
    formData.planTenure == "monthly"
      ? `$${prices.plans[formData.planName] + addOnTotal}/mo`
      : `$${prices.plans[formData.planName] * 10 + addOnTotal * 10}/yr`;
  document.getElementById("plan-total-price").innerHTML = totalPrice;

  const addOnList = document.getElementById("add-ons-list");
  addOnList.innerHTML = "";
  if (formData.planAddOns.length > 0) {
    formData.planAddOns.forEach((item) => {
      const list = document.createElement("li");
      list.innerHTML =
        formData.planTenure == "monthly"
          ? `<p class="add-on-title">${prices.addOnPrices[item].title}</p>
                         <p class="add-on-price">+$${prices.addOnPrices[item].price}/mo</p>`
          : `<p class="add-on-title">${prices.addOnPrices[item].title}</p>
                         <p class="add-on-price">+$${
                           prices.addOnPrices[item].price * 10
                         }/yr</p>`;
      addOnList.append(list);
    });
    if (formData.currentStep == 3) {
      const finalSummaryText = document.getElementById("finalSummary");
      finalSummaryText.textContent = `Thanks for confirming your subscription ${formData.name}! We hope you have fun
              using our platform. If you ever need support, please feel free to
              email us at support@lermgaing.com. We have sent the confirmation email to ${formData.email}.`;
    }
  }
}

updateSummary();

// Plan change logic

document.addEventListener("DOMContentLoaded", function () {
  const planInfoElements = document.querySelectorAll(".plan-info");
  let planPrice = "90/yr";
  planInfoElements.forEach(function (planInfoElement) {
    planInfoElement.addEventListener("click", function () {
      let currentPlanTenure = formData.planTenure;
      // Remove 'plan-selected' class from all plan info elements
      planInfoElements.forEach((element) => {
        element.classList.remove("plan-selected");
      });
      // Add 'plan-selected' class to the clicked plan info element
      this.classList.add("plan-selected");
      // Add your logic for handling the click event here
      let planName = planInfoElement
        .querySelector("h4")
        .textContent.toLowerCase();
      // Update the selected plan name to state
      formData.planName = planName;
      planPrice = prices.plans[planName];
      updatePrice(currentPlanTenure);
    });
  });
});

//Adding the selected addons to an Array for calculation

function addonToggleCheckbox(checkboxId) {
  const checkbox = document.getElementById(checkboxId);
  if (!checkbox) return;
  checkbox.checked = !checkbox.checked;
  const index = formData.planAddOns.indexOf(checkboxId);
  if (checkbox.checked && index === -1) {
    formData.planAddOns.push(checkboxId);
  } else if (!checkbox.checked && index !== -1) {
    formData.planAddOns.splice(index, 1);
  }
  updateSummary();
}


  </script>
</html>
